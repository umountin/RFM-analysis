# Требования
**Что сделать:** построить витрину для сегментации пользователей приложения с целью анализа их лояльности по трем факторам - давность, частота и денежная ценность (RFM). Таблицу назвать dm_rfm_segments, разместить в схеме analysis. 

**За какой период:** 2021 год.
**Обновление данных:** не требуется.
**Дополнительные ограничения:** Для анализа нужно отобрать заказы с статусом Closed.

В базе данных две схемы: 
  - production - содержатся оперативные таблицы
  - analysis - производится подготовка и размещение разработанной витрины

В схеме production есть следующие таблицы:
1. products
2. orderitems
3. orders
4. orderstatuslog
5. orderstatuses
6. users

Витрина должна состоять из таких полей:
- user_id
- recency (число от 1 до 5)
- frequency (число от 1 до 5)
- monetary_value (число от 1 до 5)
  
Для расчета метрик нам потребуется следующие данные:
- recency - user_id, order_ts
- frequency	- user_id, order_id
- monetary_value - user_id, cost
