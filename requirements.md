# Требования
**Что сделать:** построить витрину для сегментации пользователей приложения с целью анализа их лояльности по трем факторам - давность, частота и денежная ценность (RFM). Таблицу назвать dm_rfm_segments, разместить в схеме analysis. 

**За какой период:** 2021 год.
**Обновление данных:** не требуется.
**Дополнительные ограничения:** Для анализа нужно отобрать заказы с статусом Closed.

В базе данных две схемы: 
  - production - содержатся оперативные таблицы
  - analysis - производится подготовка и размещение разработанной витрины

В схеме production есть следующие таблицы:
1. products
2. orderitems
3. orders
4. orderstatuslog
5. orderstatuses
6. users

Витрина должна состоять из таких полей:
- user_id
- recency (число от 1 до 5)
- frequency (число от 1 до 5)
- monetary_value (число от 1 до 5)
  
Для расчета метрик нам потребуется следующие данные:
- recency - представление analysis.orders, поля: user_id, order_ts
- frequency	- представление analysis.orders, поля: user_id, order_id
- monetary_value - представление analysis.orders, поля: user_id, cost

Правила сегментации RFM:
1. Присвойте каждому клиенту три значения — значение фактора Recency, значение фактора Frequency и значение фактора Monetary:
  1.1. Фактор Recency измеряется по последнему заказу. Распределите клиентов по шкале от одного до пяти, где значение 1 получат те, кто либо вообще не делал заказов, либо делал их очень давно, а 5 — те, кто заказывал относительно недавно.
  1.2. Фактор Frequency оценивается по количеству заказов. Распределите клиентов по шкале от одного до пяти, где значение 1 получат клиенты с наименьшим количеством заказов, а 5 — с наибольшим.
  1.3. Фактор Monetary оценивается по потраченной сумме. Распределите клиентов по шкале от одного до пяти, где значение 1 получат клиенты с наименьшей суммой, а 5 — с наибольшей.
2. Проверьте, что количество клиентов в каждом сегменте одинаково. Например, если в базе всего 100 клиентов, то 20 клиентов должны получить значение 1, ещё 20 — значение 2 и т. д.
