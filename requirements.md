# Требования
Задача — построить витрину для сегментации пользователей приложения с целью анализа их лояльности по трем факторам - давность, частота и денежная ценность (RFM). 

Результат: витрина для RFM-классификации в виде таблицы базы данных с названием dm_rfm_segments, которая размещена в схеме analysis. 

Требования:
  - Для анализа нужно отобрать только успешно выполненные заказы с статусом Closed.
  - Данные за 2021 год.
  - Обновления витрины не требуются.

В базе две схемы: 
  - production - содержатся оперативные таблицы
  - analysis - производится подготовка и размещение разработанной витрины

В схеме production есть следующие таблицы:
1. products
2. orderitems
3. orders
4. orderstatuslog
5. orderstatuses
6. users

Витрина должна состоять из таких полей:
- user_id
- recency (число от 1 до 5)
- frequency (число от 1 до 5)
- monetary_value (число от 1 до 5)

Для формирования витрины нам будет достаточно сформировать запросы к таблице orders, к которым нужно будет применить фильтры по колонкам:
- status = 4
- CAST(DATE_TRUNC('year', orders.order_ts) AS date) > '2021-01-01'
  
Для расчета метрик нам потребуется следующие данные:
- recency - user_id, order_ts
- frequency	- user_id, order_id
- monetary_value - user_id, cost
